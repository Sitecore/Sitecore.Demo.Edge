USE [Sitecore.Core]

declare @UserName_ nvarchar(256) = $(UserName)
declare @EMail_ nvarchar(256) = $(EMail)
declare @EncodedPassword_ nvarchar(128) = $(EncodedPassword)
declare @EncodedSalt_ nvarchar(128) = $(EncodedSalt)

DECLARE @now datetime = GETDATE()
exec aspnet_Membership_CreateUser 'sitecore', @UserName_, @EncodedPassword_, @EncodedSalt_, @EMail_,'','', 1, @now, @now, 0, 0,null

DECLARE @UserId nvarchar(256)
SELECT TOP 1
  @UserId = [UserId]
FROM [aspnet_Users]
WHERE [UserName] = @UserName_

INSERT [dbo].[aspnet_Profile]
  ([UserId], [PropertyNames], [PropertyValuesString], [PropertyValuesBinary], [LastUpdatedDate])
VALUES
  (@UserId,
    N'Portrait:S:0:24:FullName:S:24:6:ProfileItemId:S:30:38:SerializedData:B:0:2354:',
    N'office/16x16/woman_4.pngMinnie{AE4C4969-5B7E-4B4E-9042-B2D8701CE214}',
    0x0001000000FFFFFFFF01000000000000000401000000E20153797374656D2E436F6C6C656374696F6E732E47656E657269632E44696374696F6E61727960325B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D2C5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D040000000756657273696F6E08436F6D7061726572084861736853697A650D4B657956616C756550616972730003000308920153797374656D2E436F6C6C656374696F6E732E47656E657269632E47656E65726963457175616C697479436F6D706172657260315B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D08E60153797374656D2E436F6C6C656374696F6E732E47656E657269632E4B657956616C75655061697260325B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D2C5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D5B5D0E00000009020000001100000009030000000402000000920153797374656D2E436F6C6C656374696F6E732E47656E657269632E47656E65726963457175616C697479436F6D706172657260315B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D00000000070300000000010000000A00000003E40153797374656D2E436F6C6C656374696F6E732E47656E657269632E4B657956616C75655061697260325B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D2C5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D04FCFFFFFFE40153797374656D2E436F6C6C656374696F6E732E47656E657269632E4B657956616C75655061697260325B5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D2C5B53797374656D2E537472696E672C206D73636F726C69622C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038395D5D02000000036B65790576616C7565010106050000001464696765737463726564656E7469616C68617368060600000020313961363461653830383666646165366666396134663231643537316530336101F9FFFFFFFCFFFFFF06080000002164696765737463726564656E7469616C68617368776974686F7574646F6D61696E060900000020646363323564356138313765363762333836613130343832383833366661386601F6FFFFFFFCFFFFFF060B000000202F73697465636F72655C6D696E6E69652F526962626F6E2F4D79205374726970060C000000267B44333341303634312D394631432D343938342D383334322D3036353543334430463132337D01F3FFFFFFFCFFFFFF060E0000008D012F73697465636F72655C6D696E6E69652F436F6D6D656E7420456469746F722F73697465636F72653A2F2F6D61737465722F7B30353830434544332D413032412D343434312D383633322D3243334137443641323035377D3F6C616E673D656E267665723D312F7B42463934353439462D354232342D344345452D413541372D3139323738364538353346387D060F0000000001F0FFFFFFFCFFFFFF0611000000302F73697465636F72655C6D696E6E69652F436F6E74656E7420456469746F722F4775747465722052656E6465726572730612000000267B31304630453243412D383832412D344246332D383442452D3746303134454645393130347D01EDFFFFFFFCFFFFFF06140000000A73635F52737353616C740615000000184D5A6E6C73704674337A43457A48646835634F2B30513D3D01EAFFFFFFFCFFFFFF06170000006D2F73697465636F72655C6D696E6E69652F53656374696F6E732F38463045313433323337323934363242414432304441463036373639344243425F46313033373532434634353834374530423332323939373835323735424442395F73656374696F6E2F436F6C6C61707365640618000000047472756501E7FFFFFFFCFFFFFF061A000000382F73697465636F72655C6D696E6E69652F50616E65732F503846304531343332333732393436324241443230444146303637363934424342061B0000000776697369626C6501E4FFFFFFFCFFFFFF061D0000008D012F73697465636F72655C6D696E6E69652F436F6D6D656E7420456469746F722F73697465636F72653A2F2F6D61737465722F7B42324442444241302D424241432D343136302D413937442D3136453731363641304430357D3F6C616E673D656E267665723D322F7B42463934353439462D354232342D344345452D413541372D3139323738364538353346387D090F00000001E1FFFFFFFCFFFFFF06200000001A2F73697465636F72655C6D696E6E69652F446966662F566965770621000000094F6E65436F6C756D6E0B, CAST(0x0000A2F500D2B376 AS DateTime))

UPDATE [dbo].[aspnet_Membership]
SET [PasswordFormat] = 1
WHERE [UserId] = @UserID
